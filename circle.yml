dependencies:
  pre:  
    # Install the console dependencies
    - python -c 'from w3af.core.controllers.dependency_check.dependency_check import dependency_check;dependency_check()'; true
    - if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

    # There are a couple of GUI dependencies which need to be installed 
    # using "apt-get". Asked the circle guys to install them and they
    # recommended me to run this command to make sure the virtualenv
    # can access these packages  
    - mkdir lib/python2.7/dist-packages
    - ln -s /usr/lib/python2.7/dist-packages/glib/ venv/lib/python2.7/dist-packages/
    - ln -s /usr/lib/python2.7/dist-packages/gobject/ venv/lib/python2.7/dist-packages/
    - ln -s /usr/lib/python2.7/dist-packages/gtk-2.0* venv/lib/python2.7/dist-packages/
    - ln -s /usr/lib/python2.7/dist-packages/pygtk.pth venv/lib/python2.7/dist-packages/
    - ln -s /usr/lib/python2.7/dist-packages/cairo venv/lib/python2.7/dist-packages/
    - ln -s /usr/lib/python2.7/dist-packages/pygtk.py venv/lib/python2.7/dist-packages/

    # Install the GUI dependencies
    - python -c 'from w3af.core.ui.gui.dependency_check.dependency_check import dependency_check;dependency_check()'; true
    - if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
    
    # Install the test dependencies
    - pip install mock pylint httpretty psutil logilab-astng SOAPpy

machine:
  python:
    version: 2.7.3
  
  post:
    - pyenv global system
    
test:
  override:
    - nosetests --with-doctest --doctest-tests -A "smoke and not internet and not moth and not root" w3af/core/

